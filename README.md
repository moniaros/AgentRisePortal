# AgentRise Insurance Portal

## 1. Project Overview

AgentRise is a comprehensive, modern web application designed for insurance professionals. It serves as a lead generation and management platform, featuring a bilingual interface (Greek/English), offline capabilities, and a micro-CRM for effective client management. The portal aims to streamline agent workflows, enhance client engagement, and drive business growth through intelligent tools and automation.

---

## 2. Implemented Features

### 2.1. Core Platform

-   **Bilingual Interface:** Full support for English and Greek (Ελληνικά) with a dynamic language switcher.
-   **Authentication:** Secure login and session management for agents and administrators.
-   **Offline First:** Utilizes `localStorage` and service workers to provide core functionality even when offline. Data syncs automatically when the connection is restored.
-   **Responsive Design:** A mobile-first UI that adapts seamlessly to desktops, tablets, and smartphones.
-   **Role-Based Access Control (RBAC):** Differentiates between 'Agent' and 'Admin' roles, restricting access to management sections.

### 2.2. Agent Dashboard

-   **At-a-Glance KPIs:** Key metrics are displayed prominently, including:
    -   New Leads Today
    -   New Leads This Month (with sparkline chart and MoM % change)
    -   On-Time Policy Renewal Rate (visualized as a gauge chart)
    -   Total Policies in Force
    -   Total Premiums Written (with YoY comparison)
-   **Lead-to-Policy Funnel:** A funnel chart visualizing the conversion stages from 'Leads' to 'Quotes' to 'Policies'.
-   **Renewal Notifications:** A widget highlighting policies that are expiring within the next 30 days and require follow-up.
-   **Automated Task Feed:** Displays actionable tasks and reminders generated by the automation engine.
-   **Client Testimonials:** A carousel showcasing approved client testimonials.

### 2.3. AI-Powered Tools

-   **Gap Analysis:** Agents can upload a client's existing policy document (PDF/Image). The system uses the Gemini API to:
    1.  Extract structured policy data.
    2.  Analyze the data against user-provided context (e.g., "client just had a baby").
    3.  Generate a detailed report identifying coverage gaps, upsell opportunities, and cross-sell recommendations.
-   **Social Media Composer:** An AI-powered assistant to help agents generate engaging content for social media platforms, complete with hashtag suggestions.

### 2.4. Micro-CRM

-   **Customer Management:** A central repository for all client information, including contact details, policies, and interaction history.
-   **Policy Tracking:** View all policies associated with a client, including type, premium, and active status.
-   **Interaction Timeline:** A chronological log of all activities related to a customer, such as calls, emails, meetings, and system-generated events. Agents can add notes and flag important events.

### 2.5. Marketing & Lead Generation

-   **Social Composer:** A tool for drafting, previewing, and scheduling posts to connected social media accounts (Facebook, LinkedIn, X).
-   **Ad Campaign Management:** A wizard for creating and managing digital ad campaigns, including setting objectives, budget, and creative assets.
-   **Campaign Analytics:** A dashboard to track the performance of ad campaigns, showing metrics like spend, impressions, CTR, and conversions.
-   **Lead Capture Pages:** Dynamically generated landing pages based on active ad campaigns to capture new lead information.

### 2.6. Management & Administration

-   **User Management:** Admins can invite, remove, and change the roles of users within their agency.
-   **Audit Logs:** A security log that tracks key actions performed by users, such as inviting a user or changing a role.
-   **Executive Dashboard:** A high-level overview for agency managers, featuring charts on:
    -   Agency Growth (Premium Written vs. Policies Bound)
    -   Product Mix
    -   Claims Trends
    -   Campaign ROI
-   **Automation Rules:** An overview page for administrators to monitor and manage the rules engine.

### 2.7. Localization and Internationalization

-   **Bilingual Text:** All UI components, labels, and messages are translated into Greek and English using a JSON-based i18n system.
-   **Dynamic Date/Time Formatting:** Dates and times across the application (e.g., in tables, charts, and notifications) are formatted according to the user's selected language (`el-GR` or `en-US`).
-   **Locale-Aware Number & Currency Formatting:** All numerical and currency values (e.g., KPI stats, premiums, analytics data) are displayed using the correct decimal and thousands separators for the selected locale.

---

## 3. Automation Systems

### 3.1. Rules Engine Data Model

The platform includes a flexible data model for a rules-based automation engine. The logic is defined in JSON files, allowing for business rules to be updated without code changes. The core components are:

-   **`RuleDefinition`**: The main object defining a rule, its trigger, conditions, and actions.
-   **`Trigger`**: The event that starts a rule evaluation (e.g., `POLICY_EXPIRING_SOON`).
-   **`Condition`**: A specific check that must be true (e.g., `policy.type` EQUALS `auto`).
-   **`Action`**: The operation to perform if conditions are met (e.g., `CREATE_TASK`).

**Example Rule Structure:**
```json
{
  "id": "RR-001",
  "name": "30-Day Auto Policy Renewal Reminder",
  "category": "RENEWAL_REMINDER",
  "trigger": { "eventType": "POLICY_EXPIRING_SOON", "parameters": { "daysBefore": 30 }},
  "conditions": [{ "field": "policy.type", "operator": "EQUALS", "value": "auto" }],
  "actions": [{ "actionType": "CREATE_TASK", "target": "AGENT", "template": "Follow up with..." }],
  "isEnabled": true
}
```

### 3.2. Renewal Reminder Automation

The system includes a service that simulates a daily check for policies nearing their expiration date. This service is rule-driven, processing definitions from `renewal-reminders.rules.json`.

-   **Configurable Intervals:** The engine checks for policies expiring at 90, 60, 30, 15, and 7 days.
-   **Multi-Channel Notifications:** Based on the matched rule, the system can perform multiple actions:
    -   **Create Agent Task:** Generates a task that appears on the agent's dashboard feed.
    -   **Send Email:** Sends a templated email directly to the customer.
    -   **Send SMS:** Sends a templated SMS message to the customer's mobile phone.
-   **Bilingual Templates:** Email and SMS content is stored in JSON files (`renewal-email-templates.json`, `renewal-sms-templates.json`) with both English and Greek versions. Templates support dynamic variables for personalization.
-   **Template Variables:** `{{policyholderName}}`, `{{policyNumber}}`, `{{expiryDate}}`, `{{agentName}}`, `{{agentPhone}}`.
-   **Duplicate Prevention:** A reminder log is maintained to ensure that the same notification for a specific policy and interval is not sent more than once.

### 3.3. Automation Gap Analysis

For a detailed breakdown of currently implemented, partially implemented, and missing automation features, please refer to the [Automation Gap Analysis](./automation-gap-analysis.md) document.

---

## 4. Application Structure & Pages

### 4.1. Main Navigation Menu

-   `/` (**Dashboard**): The main landing page with KPIs and widgets.
-   `/leads-dashboard` (**Leads Dashboard**): Analytics focused on lead sources and conversion funnels.
-   `/lead-generation` (**Lead Generation**): A detailed table view of all captured leads with filtering and search.
-   `/micro-crm` (**Micro CRM**): Customer and recent lead management tables.
-   `/gap-analysis` (**Gap Analysis**): The AI-powered policy analysis tool.
-   `/social-composer` (**Social Composer**): AI-assisted tool for creating social media posts.
-   `/ad-campaigns` (**Ad Campaigns**): Manage digital advertising campaigns.
-   `/analytics` (**Analytics**): View performance data for campaigns.
-   `/microsite-builder` (**Microsite Builder**): A drag-and-drop editor to build a personal agent website.
-   `/news` (**News & Updates**): A listing of global and agency-specific news articles.
-   `/testimonials` (**Testimonials**): A page for clients to submit testimonials and for admins to moderate them.

### 4.2. Management Tools (Admin Access Only)

-   `/user-management` (**User Management**): View, invite, and manage agent and admin users. Includes an audit trail of actions.
-   `/billing` (**Billing**): Placeholder for future payment and subscription management.
-   `/executive-dashboard` (**Executive Dashboard**): High-level analytics for agency performance.
-   `/settings/automation-rules` (**Automation Rules**): An overview page to monitor rule executions and navigate to different rule categories.

### 4.3. Other Pages & Routes

-   `/login` (**Login**): The authentication page.
-   `/logout` (**Logout**): Clears the user session and redirects to login.
-   `/profile` (**Profile**): The logged-in user's profile page.
-   `/settings` (**Settings**): Page for configuring social media connections and GTM.
-   `/customer/:customerId` (**Customer Profile**): A detailed view of a single customer from the CRM.
-   `/capture/:campaignId` (**Lead Capture Page**): A public-facing landing page for a specific ad campaign.
-   `/news/:articleId` (**News Article Detail**): A detailed view of a single news article.
-   `/sitemap` (**Sitemap**): An auto-generated sitemap for discoverability.
